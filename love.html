<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‹æ˜Šå®‡&å¼ å˜‰è½©çš„æ‹çˆ±çºªå¿µæ˜Ÿçƒ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Microsoft YaHei", æ€æºé»‘ä½“, å¹¼åœ†, sans-serif; }
        body { background: linear-gradient(180deg, #fff9fb 0%, #fefbff 100%); color: #333; scroll-behavior: smooth; overflow-x: hidden; min-height: 100vh; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-thumb { background: #ff9ebb; border-radius: 10px; border: 2px solid #fff9fb; }
        ::-webkit-scrollbar-track { background: #fef1f4; border-radius: 10px; }
        a { text-decoration: none; color: #ff7a9d; transition: all 0.3s; }
        .container { width: 90%; max-width: 1200px; margin: 0 auto; padding: 30px 0; }
        /* é€šç”¨æŒ‰é’® */
        .btn { transition: all 0.3s ease; cursor: pointer; border: none; border-radius: 12px; background: #ff7a9d; color: #fff; padding: 10px 20px; font-size: 14px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(255,122,157,0.2); background: #ff688f; }
        .btn-sm { padding: 6px 12px; font-size: 12px; border-radius: 8px; }
        .btn-light { background: #fef1f4; color: #ff7a9d; }
        .btn-light:hover { background: #ffe6ef; }
        /* é€šç”¨è¾“å…¥æ¡† */
        .input { flex: 1; min-width: 200px; padding: 10px 15px; border: 1px solid #fef1f4; border-radius: 10px; outline: none; transition: all 0.3s; font-size: 14px; color: #666; }
        .input:focus { border-color: #ff9ebb; box-shadow: 0 0 0 3px rgba(255,158,187,0.2); }
        .input-sm { padding: 6px 10px; font-size: 12px; min-width: 100px; }
        /* é€šç”¨åˆ é™¤æŒ‰é’® */
        .del { position: absolute; border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .del-sm { width: 20px; height: 20px; font-size: 10px; opacity: 0; }
        .del-md { width: 24px; height: 24px; font-size: 12px; }
        .item:hover .del-sm { opacity: 1; }
        /* é€šç”¨æ¨¡å—æ ‡é¢˜ */
        .section { padding: 60px 0; opacity: 0; transform: translateY(30px) scale(0.98); transition: all 0.6s cubic-bezier(0.22, 1, 0.36, 1); margin-top: 20px; }
        .section.show { opacity: 1; transform: translateY(0) scale(1); }
        .sec-title { text-align: center; font-size: 26px; margin-bottom: 10px; position: relative; font-weight: 600; padding-bottom: 10px; }
        .sec-title::after { content: ""; width: 70px; height: 3px; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); border-radius: 3px; }
        .sec-desc { text-align: center; color: #999; margin-bottom: 30px; font-size: 13px; line-height: 1.5; }
        /* é€šç”¨æ·»åŠ è¡¨å• */
        .add-form { background: #fff; border-radius: 15px; padding: 20px; box-shadow: 0 3px 15px rgba(0,0,0,0.05); margin-bottom: 30px; max-width: 900px; margin: 0 auto 30px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
        /* é€šç”¨å¡ç‰‡/é¡¹ */
        .item { position: relative; background: #fff; border-radius: 12px; transition: all 0.3s; }
        .item:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); }
        /* é€šç”¨å›¾ç‰‡å®¹å™¨ */
        .img-box { width: 100%; overflow: hidden; position: relative; cursor: pointer; display: flex; justify-content: center; align-items: center; background: #fef1f4; }
        .img-upload { position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.5); color: #fff; font-size: 12px; text-align: center; line-height: 30px; opacity: 0; transition: all 0.3s; }
        .img-box:hover .img-upload { opacity: 1; }
        .img-input { display: none; }
        .img { width: 100%; height: 100%; object-fit: cover; transition: all 0.3s; }
        /* 1. å¯†ç ç™»å½•å±‚ */
        .login-mask { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #ff7a9d33, #e8ccf733, #c8e6f733); backdrop-filter: blur(10px); z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column; gap: 20px; }
        .login-box { background: rgba(255,255,255,0.9); backdrop-filter: blur(15px); padding: 40px 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(255,122,157,0.1); border: 1px solid rgba(255,255,255,0.8); text-align: center; min-width: 300px; }
        .login-title { font-size: 22px; color: #ff7a9d; margin-bottom: 25px; }
        .login-input { width: 100%; margin-bottom: 15px; }
        .login-tip { font-size: 12px; color: #ff577f; height: 14px; margin-bottom: 10px; }
        /* å¯¼èˆª+ç•™è¨€æ»šåŠ¨ */
        .nav { position: fixed; top: 0; left: 0; width: 100%; background: linear-gradient(180deg, rgba(255,249,251,0.98) 90%, transparent); backdrop-filter: blur(8px); z-index: 998; padding: 12px 0; border-bottom: 1px solid #ffe6ef; transition: all 0.4s; }
        .nav.scroll { background: rgba(255,249,251,0.98); box-shadow: 0 2px 8px rgba(255,122,157,0.05); }
        .nav-inner { display: flex; justify-content: space-between; align-items: center; width: 90%; margin: 0 auto; }
        .logo { font-size: 18px; font-weight: bold; color: #ff7a9d; text-shadow: 0 1px 3px rgba(255,122,157,0.1); }
        .menu { display: flex; gap: 20px; list-style: none; flex-wrap: wrap; }
        .menu a { font-size: 13px; color: #666; padding: 5px 0; position: relative; }
        .menu a:hover, .menu a.active { color: #ff7a9d; transform: translateY(-1px); }
        .menu a.active::after { content: ""; position: absolute; bottom: 0; left: 0; width: 100%; height: 2px; background: #ff7a9d; border-radius: 2px; }
        /* ç•™è¨€æ»šåŠ¨æ¡ */
        .msg-scroll { position: fixed; top: 52px; left: 0; width: 100%; height: 36px; background: #ff7a9d; color: #fff; z-index: 997; overflow: hidden; white-space: nowrap; border-bottom: 1px solid #ff9ebb; }
        .msg-scroll-content { display: inline-block; line-height: 36px; font-size: 13px; padding-left: 100%; animation: scroll 30s linear infinite; }
        .msg-scroll-content span { margin: 0 15px; }
        /* é¦–é¡µæ¬¢è¿åŒº */
        .hero { height: 100vh; background: linear-gradient(rgba(255,249,251,0.95), rgba(255,249,251,0.95)), url("https://picsum.photos/seed/love-hero/1200/800") no-repeat center center; background-size: cover; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding-top: 90px; }
        .hero-title { font-size: 32px; color: #ff7a9d; margin-bottom: 15px; text-shadow: 0 2px 15px rgba(255,122,157,0.2); animation: fadeUp 1s ease; }
        .hero-slogan { font-size: 16px; color: #888; margin-bottom: 30px; animation: fadeUp 1s ease 0.2s both; }
        .timer { font-size: 36px; font-weight: bold; color: #ff7a9d; margin-bottom: 40px; background: rgba(255,255,255,0.85); backdrop-filter: blur(10px); padding: 15px 35px; border-radius: 18px; box-shadow: 0 5px 25px rgba(255,122,157,0.1); animation: fadeUp 1s ease 0.4s both; }
        /* 2. æ•…äº‹çº¿ */
        #story .sec-title { color: #ff7a9d; }
        #story .sec-title::after { background: #ff9ebb; }
        .story-timeline { position: relative; max-width: 1000px; margin: 0 auto; padding-left: 30px; }
        .story-timeline::after { content: ""; position: absolute; top: 0; bottom: 0; left: 10px; width: 2px; background: linear-gradient(to bottom, #ff9ebb, #ffe6ef); border-radius: 2px; }
        .story-item { padding: 0 0 30px 40px; position: relative; width: 100%; animation: fade 0.6s; }
        .story-item::after { content: ""; position: absolute; top: 0; left: 0; width: 22px; height: 22px; background: #fff; border: 3px solid #ff7a9d; border-radius: 50%; z-index: 1; transition: all 0.3s; box-shadow: 0 2px 5px rgba(255,122,157,0.2); }
        .story-item:hover::after { transform: scale(1.2); border-color: #ff688f; }
        .story-content { padding: 20px; background: #fff; border-radius: 15px; box-shadow: 0 3px 15px rgba(255,122,157,0.05); border-left: 3px solid #ff9ebb; position: relative; }
        .story-tag { font-size: 12px; color: white; background: linear-gradient(90deg, #ff9ebb, #ff7a9d); padding: 3px 8px; border-radius: 10px; display: inline-block; margin-bottom: 8px; cursor: pointer; }
        .story-time, .story-text { font-size: 13px; color: #ff7a9d; font-weight: 500; margin-bottom: 8px; cursor: pointer; }
        .story-text { color: #666; font-weight: normal; line-height: 1.6; margin-bottom: 12px; }
        .story-text:hover { color: #333; background: #fef1f4; padding: 2px 4px; border-radius: 4px; }
        .story-img-box { height: 200px; border-radius: 10px; }
        /* 3. åˆç…§æ”¶è— */
        #photo .sec-title { color: #9d8cff; }
        #photo .sec-title::after { background: #c8bfff; }
        .photo-cat { text-align: center; font-size: 18px; color: #9d8cff; margin: 30px 0 20px; font-weight: 500; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .photo-cat::before, .photo-cat::after { content: ""; width: 30px; height: 1px; background: #c8bfff; }
        .photo-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .photo-item { box-shadow: 0 3px 15px rgba(157,140,255,0.05); }
        .photo-del { top: 8px; right: 8px; background: #f0e8ff; color: #9d8cff; }
        .photo-del:hover { background: #c8bfff; color: #fff; }
        .photo-img-box { height: 160px; border-radius: 12px 12px 0 0; }
        .photo-img-upload { line-height: 25px; font-size: 11px; }
        .photo-desc { padding: 8px; font-size: 12px; color: #666; text-align: center; line-height: 1.4; cursor: pointer; border-radius: 0 0 12px 12px; }
        .photo-desc:hover { background: #f0e8ff; color: #9d8cff; }
        /* 4. çºªå¿µæ—¥ */
        #anniversary .sec-title { color: #68b8ff; }
        #anniversary .sec-title::after { background: #9ed0ff; }
        .anni-wrap { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .anni-card { border-radius: 15px; padding: 20px 15px; box-shadow: 0 3px 15px rgba(0,0,0,0.05); text-align: center; color: #333; border: 1px solid; }
        .color1 { background: linear-gradient(180deg, #fff0f5, #ffe6ef); border-color: #ff9ebb; }
        .color2 { background: linear-gradient(180deg, #f0e8ff, #e8ccf7); border-color: #c8bfff; }
        .color3 { background: linear-gradient(180deg, #e8f4f8, #d8eef8); border-color: #9ed0ff; }
        .color4 { background: linear-gradient(180deg, #f8fbe8, #e8f8d8); border-color: #a8e8c5; }
        .color5 { background: linear-gradient(180deg, #fff8e8, #fff2d8); border-color: #ffd89e; }
        .color6 { background: linear-gradient(180deg, #f8e8f8, #f0d8f0); border-color: #e8b8e8; }
        .anni-del { top: 10px; right: 10px; background: rgba(255,255,255,0.7); color: #666; }
        .anni-del:hover { background: #fff; color: #ff577f; transform: scale(1.1); }
        .anni-title { font-size: 16px; font-weight: 500; margin-bottom: 8px; cursor: pointer; }
        .anni-time { font-size: 12px; color: #777; margin-bottom: 15px; cursor: pointer; }
        .anni-count { font-size: 20px; font-weight: bold; margin: 8px 0; letter-spacing: 1px; }
        .color1 .anni-count { color: #ff7a9d; }
        .color2 .anni-count { color: #9d8cff; }
        .color3 .anni-count { color: #68b8ff; }
        .color4 .anni-count { color: #73d89f; }
        .color5 .anni-count { color: #ffb868; }
        .color6 .anni-count { color: #d873b8; }
        .anni-record { font-size: 11px; color: #777; line-height: 1.5; margin-top: 15px; text-align: left; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.5); cursor: pointer; }
        /* 5. 100ä»¶å°äº‹ */
        #things .sec-title { color: #73d89f; }
        #things .sec-title::after { background: #a8e8c5; }
        .things-wrap { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; max-width: 1000px; margin: 0 auto; }
        .things-item { padding: 12px 15px; box-shadow: 0 2px 10px rgba(115,216,159,0.05); display: flex; align-items: center; gap: 10px; border-left: 2px solid #a8e8c5; cursor: pointer; }
        .things-del { top: 8px; right: 8px; background: #e8f8d8; color: #73d89f; }
        .things-del:hover { background: #a8e8c5; color: #fff; }
        .things-check { width: 20px; height: 20px; border-radius: 50%; border: 2px solid #a8e8c5; display: flex; justify-content: center; align-items: center; flex-shrink: 0; transition: all 0.3s; background: #fff; }
        .things-check.done { background: linear-gradient(90deg, #73d89f, #a8e8c5); border-color: #73d89f; box-shadow: 0 1px 5px rgba(115,216,159,0.2); }
        .things-check.done::after { content: "âœ“"; color: white; font-size: 12px; font-weight: bold; animation: check 0.3s; }
        .things-text { font-size: 13px; color: #666; line-height: 1.5; padding-right: 15px; word-break: break-all; }
        /* 6. ç•™è¨€æ¿ */
        #message .sec-title { color: #ffb868; }
        #message .sec-title::after { background: #ffd89e; }
        .msg-wrap { max-width: 800px; margin: 0 auto; }
        .msg-input { background: #fff; border-radius: 15px; padding: 20px; box-shadow: 0 3px 15px rgba(255,184,104,0.05); margin-bottom: 20px; border-left: 3px solid #ffd89e; }
        .role-select { display: flex; gap: 15px; margin-bottom: 10px; align-items: center; }
        .role-item { display: flex; align-items: center; gap: 6px; cursor: pointer; }
        .role-radio { width: 16px; height: 16px; accent-color: #ffb868; }
        .role-text { font-size: 13px; color: #666; transition: all 0.2s; }
        .role-item:hover .role-text { color: #ffb868; }
        .msg-textarea { width: 100%; height: 100px; border: 1px solid #fff8e8; border-radius: 10px; padding: 15px; font-size: 14px; color: #666; resize: none; margin-bottom: 10px; outline: none; transition: all 0.3s; background: #fff8e8; }
        .msg-textarea:focus { border-color: #ffd89e; box-shadow: 0 0 0 3px rgba(255,216,158,0.2); background: #fff; }
        .msg-list { display: flex; flex-direction: column; gap: 15px; padding: 0 5px; max-height: 400px; overflow-y: auto; border-radius: 10px; }
        .msg-card { background: #fff; border-radius: 12px 12px 12px 3px; padding: 15px; box-shadow: 0 2px 10px rgba(255,184,104,0.05); align-self: flex-start; max-width: 75%; animation: fade 0.5s; border-left: 2px solid #ffb868; }
        .msg-card.yours { align-self: flex-end; background: #fff8e8; border-radius: 12px 12px 3px 12px; border-left: none; border-right: 2px solid #ffd89e; }
        .msg-del { top: 10px; right: 10px; width: 20px; height: 20px; background: transparent; color: #ffd89e; font-size: 14px; opacity: 0.6; }
        .msg-del:hover { color: #ffb868; opacity: 1; transform: scale(1.1); }
        .msg-time { font-size: 11px; color: #ccc; margin-bottom: 8px; padding-right: 20px; }
        .msg-content { font-size: 14px; color: #666; line-height: 1.6; word-break: break-all; }
        /* 7. æƒ…ä¾£æ¡£æ¡ˆ */
        #couple .sec-title { color: #ff7a9d; }
        #couple .sec-title::after { background: #ff9ebb; }
        .couple-wrap { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; max-width: 800px; margin: 0 auto; }
        .couple-card { border-radius: 15px; padding: 25px 20px; box-shadow: 0 3px 15px rgba(255,122,157,0.05); text-align: center; border: 1px solid; }
        .card-me { background: linear-gradient(180deg, #fefbff, #fff9fb); border-color: #ffe6ef; }
        .card-you { background: linear-gradient(180deg, #fff0f5, #fef1f4); border-color: #ff9ebb; }
        .avatar-box { width: 90px; height: 90px; border-radius: 50%; margin: 0 auto 15px; overflow: hidden; border: 3px solid #ffe6ef; box-shadow: 0 3px 10px rgba(255,122,157,0.1); transition: all 0.3s; position: relative; cursor: pointer; }
        .couple-card:hover .avatar-box { transform: scale(1.05); border-color: #ff9ebb; }
        .edit-text { font-size: 18px; color: #ff7a9d; margin-bottom: 10px; font-weight: 500; cursor: pointer; transition: all 0.2s; padding: 4px; border-radius: 6px; }
        .edit-text:hover { background: #ffe6ef; }
        .edit-sm { font-size: 13px; color: #666; margin: 0; font-weight: normal; }
        .edit-key { color: #999; }
        .edit-tag { font-size: 12px; color: #ff7a9d; background: #ffe6ef; padding: 4px 10px; border-radius: 15px; margin: 0 5px 8px; display: inline-block; position: relative; }
        .tag-del { position: absolute; top: -3px; right: -3px; width: 12px; height: 12px; border: none; background: #ff9ebb; color: #fff; border-radius: 50%; font-size: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; opacity: 0; transition: all 0.2s; }
        .edit-tag:hover .tag-del { opacity: 1; }
        .tag-del:hover { background: #ff7a9d; }
        .tag-add { display: flex; gap: 8px; align-items: center; margin-top: 10px; justify-content: center; }
        .couple-info { text-align: left; margin-top: 20px; padding-top: 15px; border-top: 1px solid #fef9fb; }
        .info-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #fef9fb; font-size: 13px; }
        .info-item:last-child { border-bottom: none; }
        .couple-tag { margin-top: 20px; display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
        /* é¡µè„š+å›åˆ°é¡¶éƒ¨+ç…§ç‰‡é¢„è§ˆ */
        .footer { background: linear-gradient(180deg, #fff9fb, #fff0f5); padding: 40px 0 20px; text-align: center; margin-top: 60px; border-top: 1px solid #ffe6ef; }
        .footer-text { color: #ff9ebb; font-size: 15px; margin-bottom: 10px; line-height: 1.6; }
        .copyright { color: #ccc; font-size: 12px; }
        .back-top { position: fixed; bottom: 20px; right: 20px; width: 40px; height: 40px; border-radius: 50%; background: #ff7a9d; color: #fff; display: flex; justify-content: center; align-items: center; font-size: 18px; box-shadow: 0 3px 10px rgba(255,122,157,0.2); cursor: pointer; transition: all 0.3s; opacity: 0; visibility: hidden; z-index: 996; }
        .back-top.show { opacity: 1; visibility: visible; }
        .back-top:hover { transform: translateY(-2px); background: #ff688f; box-shadow: 0 5px 15px rgba(255,122,157,0.3); }
        .photo-mask { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(5px); display: none; justify-content: center; align-items: center; z-index: 9999; padding: 20px; }
        .photo-mask.show { display: flex; }
        .mask-img { max-width: 90%; max-height: 90vh; border-radius: 12px; box-shadow: 0 10px 50px rgba(0,0,0,0.3); }
        /* é€šç”¨åŠ¨ç”» */
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
        @keyframes fadeUp { 0% { opacity: 0; transform: translateY(20px); } 100% { opacity: 1; transform: translateY(0); } }
        @keyframes fade { 0% { opacity: 0; } 100% { opacity: 1; } }
        @keyframes check { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .login-box { padding: 30px 20px; min-width: 260px; }
            .menu { gap: 10px; }
            .logo { font-size: 16px; }
            .menu a { font-size: 12px; }
            .msg-scroll { top: 48px; height: 32px; }
            .msg-scroll-content { line-height: 32px; font-size: 12px; }
            .hero { padding-top: 80px; }
            .hero-title { font-size: 26px; }
            .timer { font-size: 24px; padding: 12px 25px; border-radius: 15px; }
            .section { padding: 40px 0; }
            .sec-title { font-size: 22px; }
            .story-timeline { padding-left: 20px; }
            .story-item { padding-left: 30px; }
            .story-img-box { height: 150px; }
            .photo-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
            .photo-img-box { height: 120px; }
            .photo-cat { font-size: 16px; margin: 20px 0 15px; }
            .anni-wrap, .couple-wrap { grid-template-columns: 1fr; gap: 15px; }
            .things-wrap { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 8px; }
            .msg-card { max-width: 85%; padding: 12px; }
            .msg-list { max-height: 300px; }
            .add-form { flex-direction: column; align-items: stretch; }
            .input { min-width: 100%; }
            .back-top { width: 35px; height: 35px; bottom: 15px; right: 15px; font-size: 16px; }
        }
        @media (max-width: 480px) {
            .photo-grid { grid-template-columns: 1fr; }
            .timer { font-size: 20px; padding: 10px 20px; }
            .hero-slogan { font-size: 14px; }
            .msg-scroll-content span { margin: 0 10px; }
            .add-form { padding: 15px; }
        }
    </style>
</head>
<body>
    <!-- å¯†ç ç™»å½• -->
    <div class="login-mask" id="loginMask">
        <div class="login-box">
            <h3 class="login-title">æ¬¢è¿æ¥åˆ°æ˜Šå®‡&å˜‰è½©çš„æ‹çˆ±æ˜Ÿçƒ</h3>
            <input type="password" class="input login-input" id="pwdInput" placeholder="è¯·è¾“å…¥è¿›å…¥å¯†ç ">
            <div class="login-tip" id="loginTip"></div>
            <button class="btn" onclick="checkPwd()">è¿›å…¥æ˜Ÿçƒ</button>
        </div>
    </div>

    <!-- å¯¼èˆª -->
    <nav class="nav" id="nav">
        <div class="nav-inner">
            <div class="logo">æ˜Šå®‡&å˜‰è½©çš„æ‹çˆ±æ˜Ÿçƒ</div>
            <ul class="menu">
                <li><a href="#story" class="nav-link">æˆ‘ä»¬çš„æ•…äº‹</a></li>
                <li><a href="#photo" class="nav-link">åˆç…§æ”¶è—</a></li>
                <li><a href="#anniversary" class="nav-link">ä¸“å±çºªå¿µæ—¥</a></li>
                <li><a href="#things" class="nav-link">100ä»¶å°äº‹</a></li>
                <li><a href="#message" class="nav-link">ç”œè¨€èœœè¯­</a></li>
                <li><a href="#couple" class="nav-link">æƒ…ä¾£æ¡£æ¡ˆ</a></li>
            </ul>
        </div>
    </nav>

    <!-- ç•™è¨€æ»šåŠ¨ -->
    <div class="msg-scroll" id="msgScroll">
        <div class="msg-scroll-content" id="msgScrollContent">
            <span>ğŸ’“ æ˜Šå®‡&å˜‰è½©ï¼ŒåŒå‘å¥”èµ´çš„æ¸©æŸ”ï¼Œè—åœ¨æ¯ä¸€å¥ç”œè¨€èœœè¯­é‡Œ ğŸ’“</span>
        </div>
    </div>

    <!-- é¦–é¡µ -->
    <section class="hero" id="hero">
        <h1 class="hero-title">ç‹æ˜Šå®‡ & å¼ å˜‰è½©</h1>
        <p class="hero-slogan">ä¸‰é¤å››å­£ï¼Œå²å²å¹´å¹´ï¼Œä»é‡è§å¼€å§‹ï¼Œä½™ç”Ÿéƒ½æ˜¯ä½ </p>
        <div class="timer" id="loveTimer">0å¤©0æ—¶0åˆ†0ç§’</div>
        <button class="btn" onclick="document.querySelector('#story').scrollIntoView({behavior:'smooth'})">è¿›å…¥æˆ‘ä»¬çš„æ•…äº‹</button>
    </section>

    <!-- æˆ‘ä»¬çš„æ•…äº‹ -->
    <section class="section" id="story">
        <div class="container">
            <h2 class="sec-title">æˆ‘ä»¬çš„æ•…äº‹çº¿</h2>
            <p class="sec-desc">ä»ç›¸é‡çš„å¿ƒåŠ¨ï¼Œåˆ°ç›¸å®ˆçš„æ¸©æŸ”ï¼Œæ¯ä¸€ä¸ªç¬é—´éƒ½å€¼å¾—çè—</p>
            <div class="add-form">
                <input type="text" class="input input-sm" id="storyTag" placeholder="æ•…äº‹æ ‡ç­¾ï¼ˆå¦‚ï¼šğŸ’“ åˆæ¬¡ç›¸é‡ï¼‰">
                <input type="text" class="input input-sm" id="storyTime" placeholder="æ—¶é—´ï¼ˆå¦‚ï¼š2023å¹´12æœˆ6æ—¥ï¼‰">
                <input type="text" class="input" id="storyText" placeholder="æ•…äº‹å†…å®¹">
                <button class="btn" onclick="addData('stories', {tag:storyTag,time:storyTime,text:storyText,img:'https://picsum.photos/seed/love-new/500/500'})">æ·»åŠ æ•…äº‹</button>
            </div>
            <div class="story-timeline" id="storyTimeline"></div>
        </div>
    </section>

    <!-- åˆç…§æ”¶è— -->
    <section class="section" id="photo">
        <div class="container">
            <h2 class="sec-title">åˆç…§æ”¶è—å¤¹</h2>
            <p class="sec-desc">æŠŠæ¯ä¸€ä¸ªç”œèœœç¬é—´ï¼Œéƒ½è—åœ¨æ—¶å…‰é‡Œ</p>
            <!-- æ—¥å¸¸ -->
            <h3 class="photo-cat">ğŸ“¸ æ—¥å¸¸ç‚¹æ»´</h3>
            <div class="add-form"><button class="btn btn-light" onclick="addData('photos', {type:'daily',data:{img:'https://picsum.photos/seed/love-photo/500/500',desc:'è¯·ç¼–è¾‘æè¿°ï½'}})">æ·»åŠ æ—¥å¸¸åˆç…§</button></div>
            <div class="photo-grid" id="photoDaily"></div>
            <!-- æ—…è¡Œ -->
            <h3 class="photo-cat">âœˆï¸ æ—…è¡Œæ‰“å¡</h3>
            <div class="add-form"><button class="btn btn-light" onclick="addData('photos', {type:'travel',data:{img:'https://picsum.photos/seed/love-photo/500/500',desc:'è¯·ç¼–è¾‘æè¿°ï½'}})">æ·»åŠ æ—…è¡Œåˆç…§</button></div>
            <div class="photo-grid" id="photoTravel"></div>
            <!-- èŠ‚æ—¥ -->
            <h3 class="photo-cat">ğŸ èŠ‚æ—¥çºªå¿µ</h3>
            <div class="add-form"><button class="btn btn-light" onclick="addData('photos', {type:'holiday',data:{img:'https://picsum.photos/seed/love-photo/500/500',desc:'è¯·ç¼–è¾‘æè¿°ï½'}})">æ·»åŠ èŠ‚æ—¥åˆç…§</button></div>
            <div class="photo-grid" id="photoHoliday"></div>
        </div>
    </section>

    <!-- ä¸“å±çºªå¿µæ—¥ -->
    <section class="section" id="anniversary">
        <div class="container">
            <h2 class="sec-title">ä¸“å±çºªå¿µæ—¥</h2>
            <p class="sec-desc">é‡è¦çš„æ—¥å­ï¼Œæ°¸è¿œä¸ä¼šå¿˜è®°ï¼Œæ¯å¹´éƒ½è¦ä¸€èµ·åº†ç¥</p>
            <div class="add-form">
                <input type="text" class="input" id="anniName" placeholder="çºªå¿µæ—¥åç§°ï¼ˆå¦‚ï¼šåœ¨ä¸€èµ·çºªå¿µæ—¥ï¼‰">
                <input type="text" class="input input-sm" id="anniDate" placeholder="æ—¥æœŸï¼ˆæœˆ-æ—¥ï¼Œå¦‚ï¼š12-6ï¼‰">
                <input type="text" class="input" id="anniRecord" placeholder="å†å¹´è®°å½•ï¼ˆé€‰å¡«ï¼‰">
                <button class="btn" onclick="addData('anniversaries', {name:anniName,date:anniDate,record:anniRecord||'å¾…æ·»åŠ è®°å½•ï½'})">æ·»åŠ çºªå¿µæ—¥</button>
            </div>
            <div class="anni-wrap" id="anniWrap"></div>
        </div>
    </section>

    <!-- 100ä»¶å°äº‹ -->
    <section class="section" id="things">
        <div class="container">
            <h2 class="sec-title">æˆ‘ä»¬çš„100ä»¶å°äº‹</h2>
            <p class="sec-desc">ä¸€èµ·å®Œæˆï¼Œä¸€èµ·è§£é”ï¼ŒæŠŠå¹³å‡¡çš„æ—¥å­è¿‡æˆè¯—</p>
            <div class="add-form things-add">
                <input type="text" class="input" id="thingsText" placeholder="è¾“å…¥è¦ä¸€èµ·åšçš„å°äº‹">
                <button class="btn" onclick="addData('things', {text:thingsText,done:false})">æ·»åŠ å°äº‹</button>
            </div>
            <div class="things-wrap" id="thingsWrap"></div>
        </div>
    </section>

    <!-- ç”œè¨€èœœè¯­ -->
    <section class="section" id="message">
        <div class="container">
            <h2 class="sec-title">ç”œè¨€èœœè¯­ç•™è¨€æ¿</h2>
            <p class="sec-desc">æŠŠæƒ³è¯´çš„è¯è—åœ¨è¿™é‡Œï¼ŒåŒå‘å¥”èµ´çš„æ¸©æŸ”</p>
            <div class="msg-wrap">
                <div class="msg-input">
                    <div class="role-select">
                        <div class="role-item">
                            <input type="radio" name="role" id="roleMe" class="role-radio" checked>
                            <label for="roleMe" class="role-text">æ˜Šå®‡</label>
                        </div>
                        <div class="role-item">
                            <input type="radio" name="role" id="roleYou" class="role-radio">
                            <label for="roleYou" class="role-text">å˜‰è½©</label>
                        </div>
                    </div>
                    <textarea class="msg-textarea" id="msgInput" placeholder="å†™ä¸‹æƒ³å¯¹å¯¹æ–¹è¯´çš„ç”œè¨€èœœè¯­å§ï½"></textarea>
                    <button class="btn" onclick="sendMsg()">å‘é€ç”œèœœ</button>
                </div>
                <div class="msg-list" id="msgList"></div>
            </div>
        </div>
    </section>

    <!-- æƒ…ä¾£æ¡£æ¡ˆ -->
    <section class="section" id="couple">
        <div class="container">
            <h2 class="sec-title">æƒ…ä¾£ä¸“å±æ¡£æ¡ˆ</h2>
            <p class="sec-desc">è—ç€å½¼æ­¤çš„å°ç»†èŠ‚ï¼ŒåŸæ¥æˆ‘è¿™ä¹ˆäº†è§£ä½ </p>
            <div class="couple-wrap">
                <!-- æ˜Šå®‡ -->
                <div class="couple-card card-me" id="coupleMe">
                    <div class="avatar-box" onclick="document.getElementById('avatarMeInput').click()">
                        <img src="https://picsum.photos/seed/boy/100/100" alt="æ˜Šå®‡" class="img" id="avatarMe">
                        <div class="img-upload">æ›´æ¢å¤´åƒ</div>
                        <input type="file" class="img-input" id="avatarMeInput" accept="image/*" onchange="uploadImg('avatar_me', 'avatarMe', this)">
                    </div>
                    <div class="edit-text" id="meName" onclick="editText(this)">ç‹æ˜Šå®‡</div>
                    <div class="couple-info">
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">ç”Ÿæ—¥</span><span class="edit-text edit-sm" onclick="editText(this)">Xå¹´XæœˆXæ—¥</span></div>
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">æ˜Ÿåº§</span><span class="edit-text edit-sm" onclick="editText(this)">XXåº§</span></div>
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">å°ç™–å¥½</span><span class="edit-text edit-sm" onclick="editText(this)">å¾…ç¼–è¾‘ï½</span></div>
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">å°ä¼˜ç‚¹</span><span class="edit-text edit-sm" onclick="editText(this)">å¾…ç¼–è¾‘ï½</span></div>
                    </div>
                    <div class="couple-tag" id="meTag">
                        <span class="edit-tag">å® å¦»ç‹‚é­”<span class="tag-del" onclick="this.parentElement.remove()">Ã—</span></span>
                        <span class="edit-tag">å¹²é¥­æ­å­<span class="tag-del" onclick="this.parentElement.remove()">Ã—</span></span>
                    </div>
                    <div class="tag-add">
                        <input type="text" class="input input-sm" id="meTagInput" placeholder="æ·»åŠ æ ‡ç­¾">
                        <button class="btn btn-sm" onclick="addTag('meTag', meTagInput)">+</button>
                    </div>
                </div>
                <!-- å˜‰è½© -->
                <div class="couple-card card-you" id="coupleYou">
                    <div class="avatar-box" onclick="document.getElementById('avatarYouInput').click()">
                        <img src="https://picsum.photos/seed/girl/100/100" alt="å˜‰è½©" class="img" id="avatarYou">
                        <div class="img-upload">æ›´æ¢å¤´åƒ</div>
                        <input type="file" class="img-input" id="avatarYouInput" accept="image/*" onchange="uploadImg('avatar_you', 'avatarYou', this)">
                    </div>
                    <div class="edit-text" id="youName" onclick="editText(this)">å¼ å˜‰è½©</div>
                    <div class="couple-info">
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">ç”Ÿæ—¥</span><span class="edit-text edit-sm" onclick="editText(this)">Xå¹´XæœˆXæ—¥</span></div>
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">æ˜Ÿåº§</span><span class="edit-text edit-sm" onclick="editText(this)">XXåº§</span></div>
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">å°ç™–å¥½</span><span class="edit-text edit-sm" onclick="editText(this)">å¾…ç¼–è¾‘ï½</span></div>
                        <div class="info-item"><span class="edit-text edit-key" onclick="editText(this)">å°ä¼˜ç‚¹</span><span class="edit-text edit-sm" onclick="editText(this)">å¾…ç¼–è¾‘ï½</span></div>
                    </div>
                    <div class="couple-tag" id="youTag">
                        <span class="edit-tag">å¯çˆ±è½¯èŒ<span class="tag-del" onclick="this.parentElement.remove()">Ã—</span></span>
                        <span class="edit-tag">å¥¶èŒ¶æ­å­<span class="tag-del" onclick="this.parentElement.remove()">Ã—</span></span>
                    </div>
                    <div class="tag-add">
                        <input type="text" class="input input-sm" id="youTagInput" placeholder="æ·»åŠ æ ‡ç­¾">
                        <button class="btn btn-sm" onclick="addTag('youTag', youTagInput)">+</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="footer-text">ç‹æ˜Šå®‡&å¼ å˜‰è½© æ„¿å²å²å¹´å¹´ï¼Œæ»¡å¿ƒæ¬¢å–œï¼Œå…±èµ´ç™½å¤´</div>
        <div class="copyright">Â©2025 ä¸“å±æ‹çˆ±çºªå¿µæ˜Ÿçƒ Â· æ‰€æœ‰ç”œèœœçš†ä¸ºä¸“å±</div>
    </footer>

    <!-- å›åˆ°é¡¶éƒ¨+ç…§ç‰‡é¢„è§ˆ -->
    <div class="back-top" id="backTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">â†‘</div>
    <div class="photo-mask" id="photoMask" onclick="this.classList.remove('show')">
        <img src="" alt="é¢„è§ˆ" class="mask-img" id="maskImg">
    </div>

    <script>
        // æ ¸å¿ƒé…ç½®
        const PWD = "231206", LOVE_START = new Date(2023, 11, 6, 19, 34);
        // åˆå§‹æ•°æ®
        const initData = {
            stories: [{tag:"ğŸ’“ åˆæ¬¡ç›¸é‡",time:"2023å¹´ç§‹",text:"é‡è§ä½ çš„é‚£ä¸€åˆ»ï¼Œæ˜Ÿæ²³çš†æ˜",img:"https://picsum.photos/seed/love-meet/500/500"},{tag:"ğŸ’ å‘Šç™½ç¬é—´",time:"2023å¹´12æœˆ6æ—¥",text:"æ­£å¼å‘Šç™½ï¼Œç¡®å®šå½¼æ­¤",img:"https://picsum.photos/seed/love-propose/500/500"}],
            photos: {daily:[{img:"https://picsum.photos/seed/love-daily1/500/500",desc:"ä¸€èµ·çªæ²™å‘è¿½å‰§"}],travel:[{img:"https://picsum.photos/seed/love-travel1/500/500",desc:"ä¸€èµ·å»çœ‹æµ·"}],holiday:[{img:"https://picsum.photos/seed/love-holiday1/500/500",desc:"ç¬¬ä¸€ä¸ªæƒ…äººèŠ‚"}]},
            anniversaries: [{name:"åœ¨ä¸€èµ·çºªå¿µæ—¥",date:"12-6",record:"2023å¹´ï¼šæ­£å¼åœ¨ä¸€èµ·<br>å²å²å¹´å¹´ï¼Œå¦‚çº¦è€Œè‡³"},{name:"æƒ…äººèŠ‚",date:"2-14",record:"å¾…è§£é”ç”œèœœæ—¶å…‰ï½"}],
            things: [{text:"ä¸€èµ·çœ‹æµªæ¼«ç”µå½±",done:false},{text:"ä¸€èµ·åšä¸°ç››æ™šé¤",done:false},{text:"ä¸€èµ·æµ·è¾¹çœ‹æ—¥å‡º",done:false}],
            messages: [{role:"me",text:"å®è´ï¼Œé‡è§ä½ æ˜¯æˆ‘è¿™è¾ˆå­æœ€å¹¸è¿çš„äº‹ï½",time:"2023-12-06 19:34"},{role:"you",text:"æ˜Šå®‡ï¼Œä½™ç”Ÿè¯·å¤šæŒ‡æ•™å•¦ï½",time:"2023-12-06 19:36"}],
            avatar_me: "https://picsum.photos/seed/boy/100/100",
            avatar_you: "https://picsum.photos/seed/girl/100/100"
        };
        // æœ¬åœ°å­˜å‚¨å·¥å…·
        const get = k => JSON.parse(localStorage.getItem(`love_${k}`)) || initData[k];
        const set = (k, v) => localStorage.setItem(`love_${k}`, JSON.stringify(v));
        // åˆå§‹åŒ–å­˜å‚¨
        Object.keys(initData).forEach(k => !localStorage.getItem(`love_${k}`) && set(k, initData[k]));

        // é¡µé¢åˆå§‹åŒ–
        window.onload = () => {
            initTimer(); renderAll(); initScroll(); initPreview();
            document.getElementById("pwdInput").addEventListener("keydown", e => e.key === "Enter" && checkPwd());
            document.getElementById("msgInput").addEventListener("keydown", e => e.key === "Enter" && !e.shiftKey && (e.preventDefault(), sendMsg()));
        };

        // 1. å¯†ç éªŒè¯
        function checkPwd() {
            const val = document.getElementById("pwdInput").value.trim(), tip = document.getElementById("loginTip");
            if (!val) tip.innerText = "è¯·è¾“å…¥å¯†ç ï½";
            else if (val === PWD) { document.getElementById("loginMask").style.display = "none"; document.querySelectorAll(".section").forEach(s => s.classList.add("show")); }
            else { tip.innerText = "å¯†ç é”™è¯¯ï½"; document.getElementById("pwdInput").value = ""; }
        }

        // 2. æ‹çˆ±è®¡æ—¶
        function initTimer() {
            const update = () => {
                const diff = new Date() - LOVE_START;
                const d = Math.floor(diff / 86400000), h = Math.floor((diff % 86400000) / 3600000);
                const m = Math.floor((diff % 3600000) / 60000), s = Math.floor((diff % 60000) / 1000);
                document.getElementById("loveTimer").innerText = `${d}å¤©${h}æ—¶${m}åˆ†${s}ç§’`;
            };
            update(); setInterval(update, 1000);
        }

        // 3. é€šç”¨å¢åˆ æ”¹
        function addData(type, data) {
            // éªŒè¯å¿…å¡«
            if ((type === "stories" && !data.tag) || (type === "anniversaries" && !data.name) || (type === "things" && !data.text)) {
                alert("å†…å®¹ä¸èƒ½ä¸ºç©ºå“¦ï½"); return;
            }
            // 100ä»¶å°äº‹é™åˆ¶
            if (type === "things" && get("things").length >= 100) { alert("100ä»¶å°äº‹å·²æ”¶é›†æ»¡ï½"); return; }
            // çºªå¿µæ—¥æ—¥æœŸéªŒè¯
            if (type === "anniversaries" && !/^\d{1,2}-\d{1,2}$/.test(data.date)) { alert("æ—¥æœŸæ ¼å¼ï¼šæœˆ-æ—¥ï½"); return; }
            
            let res = get(type);
            if (type === "photos") { res[data.type].push(data.data); }
            else { res.push(data); }
            set(type, res); renderAll();
            // æ¸…ç©ºè¾“å…¥æ¡†
            document.querySelectorAll(`#${type}Name, #${type}Tag, #${type}Time, #${type}Text, #anniDate, #anniRecord`).forEach(i => i && (i.value = ""));
        }

        function delData(type, idx, subType) {
            if (!confirm("ç¡®å®šåˆ é™¤å—ï¼Ÿ")) return;
            let res = get(type);
            subType ? res[subType].splice(idx, 1) : res.splice(idx, 1);
            set(type, res); renderAll();
        }

        function editData(type, idx, key, subType) {
            const res = get(type);
            const oldVal = subType ? res[subType][idx][key] : res[idx][key];
            const newVal = prompt(`ç¼–è¾‘${key}`, oldVal);
            if (newVal === null || !newVal.trim()) return;
            subType ? res[subType][idx][key] = newVal.trim() : res[idx][key] = newVal.trim();
            set(type, res); renderAll();
        }

        // 4. é€šç”¨å›¾ç‰‡ä¸Šä¼ 
        function uploadImg(key, elId, fileEl) {
            const file = fileEl.files[0]; if (!file) return;
            const reader = new FileReader();
            reader.onload = e => { set(key, e.target.result); document.getElementById(elId).src = e.target.result; fileEl.value = ""; };
            reader.readAsDataURL(file);
        }

        function uploadModuleImg(type, idx, subType, fileEl) {
            const file = fileEl.files[0]; if (!file) return;
            const reader = new FileReader();
            reader.onload = e => {
                const res = get(type);
                subType ? res[subType][idx].img = e.target.result : res[idx].img = e.target.result;
                set(type, res); renderAll(); fileEl.value = "";
            };
            reader.readAsDataURL(file);
        }

        // 5. å„æ¨¡å—æ¸²æŸ“
        function renderStories() {
            const list = get("stories"), el = document.getElementById("storyTimeline");
            el.innerHTML = list.map((item, i) => `
                <div class="story-item">
                    <div class="story-content">
                        <button class="del del-md" style="top:10px;right:10px;background:#ffe6ef;color:#ff7a9d;" onclick="delData('stories',${i})">Ã—</button>
                        <div class="story-tag" onclick="editData('stories',${i},'tag')">${item.tag}</div>
                        <div class="story-time" onclick="editData('stories',${i},'time')">${item.time}</div>
                        <div class="story-text" onclick="editData('stories',${i},'text')">${item.text}</div>
                        <div class="img-box story-img-box" onclick="document.getElementById('storyImg${i}').click()">
                            <img src="${item.img}" class="img">
                            <div class="img-upload">æ›´æ¢å›¾ç‰‡</div>
                            <input type="file" class="img-input" id="storyImg${i}" accept="image/*" onchange="uploadModuleImg('stories',${i},null,this)">
                        </div>
                    </div>
                </div>
            `).join("");
        }

        function renderPhotos() {
            const data = get("photos");
            Object.keys(data).forEach(type => {
                const list = data[type], el = document.getElementById(`photo${type.charAt(0).toUpperCase()+type.slice(1)}`);
                el.innerHTML = list.map((item, i) => `
                    <div class="item photo-item">
                        <button class="del del-sm photo-del" onclick="delData('photos',${i},'${type}')">Ã—</button>
                        <div class="img-box photo-img-box" onclick="previewPhoto('${item.img}')">
                            <img src="${item.img}" class="img">
                            <div class="img-upload photo-img-upload">æ›´æ¢å›¾ç‰‡</div>
                            <input type="file" class="img-input" id="photoImg${type}${i}" accept="image/*" onchange="uploadModuleImg('photos',${i},'${type}',this)">
                        </div>
                        <div class="photo-desc" onclick="editData('photos',${i},'desc','${type}')">${item.desc}</div>
                    </div>
                `).join("");
            });
        }

        function renderAnni() {
            const list = get("anniversaries"), el = document.getElementById("anniWrap");
            el.innerHTML = list.map((item, i) => {
                const color = `color${(i%6)+1}`, count = getAnniCount(item.date);
                return `
                    <div class="anni-card ${color}">
                        <button class="del del-md anni-del" onclick="delData('anniversaries',${i})">Ã—</button>
                        <div class="anni-title" onclick="editData('anniversaries',${i},'name')">${item.name}</div>
                        <div class="anni-time" onclick="editData('anniversaries',${i},'date')">æ¯å¹´${item.date}</div>
                        <div class="anni-count">${count}</div>
                        <div class="anni-record" onclick="editData('anniversaries',${i},'record')">${item.record}</div>
                    </div>
                `;
            }).join("");
        }

        function getAnniCount(date) {
            if (date === "X-X") return "å¾…è®¾ç½®";
            const [m, d] = date.split("-").map(Number), now = new Date();
            let next = new Date(now.getFullYear(), m-1, d);
            if (next < now) next = new Date(now.getFullYear()+1, m-1, d);
            const days = Math.floor((next - now)/86400000);
            return days === 0 ? "ä»Šå¤©å“¦ğŸ’“" : `${days}å¤©å`;
        }

        function renderThings() {
            const list = get("things"), el = document.getElementById("thingsWrap"), addEl = document.querySelector(".things-add");
            if (list.length >= 100) addEl.innerHTML = "<div style='color:#73d89f;text-align:center;'>ğŸ’“ 100ä»¶å°äº‹å·²æ”¶é›†æ»¡ï½</div>";
            el.innerHTML = list.map((item, i) => `
                <div class="item things-item">
                    <button class="del del-sm things-del" onclick="delData('things',${i})">Ã—</button>
                    <div class="things-check ${item.done?'done':''}" onclick="toggleDone(${i})"></div>
                    <div class="things-text" onclick="editData('things',${i},'text')">${item.text}</div>
                </div>
            `).join("");
        }

        function toggleDone(idx) {
            const list = get("things"); list[idx].done = !list[idx].done; set("things", list); renderThings();
        }

        function renderMsg() {
            const list = get("messages"), el = document.getElementById("msgList");
            el.innerHTML = list.map((item, i) => `
                <div class="msg-card ${item.role==='you'?'yours':''}">
                    <button class="del del-sm msg-del" onclick="delData('messages',${i})">Ã—</button>
                    <div class="msg-time">${item.time}</div>
                    <div class="msg-content">${item.text}</div>
                </div>
            `).join("");
            el.scrollTop = el.scrollHeight;
        }

        function sendMsg() {
            const val = document.getElementById("msgInput").value.trim();
            if (!val) { alert("è¯·è¾“å…¥ç•™è¨€ï½"); return; }
            const role = document.getElementById("roleMe").checked ? "me" : "you";
            const now = new Date(), time = `${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,0)}-${now.getDate().toString().padStart(2,0)} ${now.getHours().toString().padStart(2,0)}:${now.getMinutes().toString().padStart(2,0)}`;
            const list = get("messages"); list.push({role,text:val,time}); set("messages", list); renderMsg();
            document.getElementById("msgInput").value = "";
        }

        // 6. æƒ…ä¾£æ¡£æ¡ˆå·¥å…·
        function editText(el) {
            const old = el.innerText.trim(), val = prompt("ç¼–è¾‘å†…å®¹", old);
            val && val.trim() && (el.innerText = val.trim());
        }

        function addTag(elId, inputEl) {
            const val = inputEl.value.trim();
            if (!val) { alert("è¯·è¾“å…¥æ ‡ç­¾ï½"); return; }
            document.getElementById(elId).innerHTML += `<span class="edit-tag">${val}<span class="tag-del" onclick="this.parentElement.remove()">Ã—</span></span>`;
            inputEl.value = "";
        }

        // 7. é€šç”¨åŠŸèƒ½
        function previewPhoto(img) {
            document.getElementById("maskImg").src = img;
            document.getElementById("photoMask").classList.add("show");
        }

        function initScroll() {
            const nav = document.getElementById("nav"), backTop = document.getElementById("backTop"), sections = document.querySelectorAll(".section"), links = document.querySelectorAll(".nav-link");
            window.onscroll = () => {
                const st = document.documentElement.scrollTop || document.body.scrollTop;
                // å¯¼èˆª+å›åˆ°é¡¶éƒ¨
                st > 50 ? nav.classList.add("scroll") : nav.classList.remove("scroll");
                st > 300 ? backTop.classList.add("show") : backTop.classList.remove("show");
                // æ¨¡å—æ˜¾éš
                sections.forEach(s => s.getBoundingClientRect().top < window.innerHeight*0.8 && s.classList.add("show"));
                // å¯¼èˆªé«˜äº®
                sections.forEach(s => {
                    const top = s.offsetTop - 100, id = s.id;
                    if (st >= top) { links.forEach(l => l.classList.remove("active")); document.querySelector(`.nav-link[href="#${id}"]`).classList.add("active"); }
                });
            };
        }

        function initPreview() { window.previewPhoto = previewPhoto; }

        // æ¸²æŸ“æ‰€æœ‰
        function renderAll() {
            renderStories(); renderPhotos(); renderAnni(); renderThings(); renderMsg();
            document.getElementById("avatarMe").src = get("avatar_me");
            document.getElementById("avatarYou").src = get("avatar_you");
            setInterval(renderAnni, 60000);
        }
    </script>
</body>
</html>
